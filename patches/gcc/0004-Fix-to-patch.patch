From c3c5513c7ec6e035be5565c2666e960766b89094 Mon Sep 17 00:00:00 2001
From: Nuno Silva <little.coding.fox@gmail.com>
Date: Sun, 17 Oct 2021 18:00:28 +0100
Subject: [PATCH] Fix to patch

---
 config.sub                |  8 +-------
 gcc/config.gcc            | 22 ++--------------------
 gcc/config/toast-system.h |  2 --
 gcc/config/toast.h        |  5 ++++-
 4 files changed, 7 insertions(+), 30 deletions(-)
 delete mode 100644 gcc/config/toast-system.h

diff --git a/config.sub b/config.sub
index b8a28e75d03..275b2ff49ba 100755
--- a/config.sub
+++ b/config.sub
@@ -132,7 +132,7 @@ case $1 in
 		maybe_os=$field2-$field3
 		case $maybe_os in
 			nto-qnx* | linux-* | uclinux-uclibc* \
-			| uclinux-gnu* | kfreebsd*-gnu* | knetbsd*-gnu* | netbsd*-gnu* | toast-system* \
+			| uclinux-gnu* | kfreebsd*-gnu* | knetbsd*-gnu* | netbsd*-gnu* \
 			| netbsd*-eabi* | kopensolaris*-gnu* | cloudabi*-eabi* \
 			| storm-chaos* | os2-emx* | rtmk-nova*)
 				basic_machine=$field1
@@ -1313,10 +1313,6 @@ EOF
 		kernel=linux
 		os=$(echo $basic_os | sed -e 's|linux|gnu|')
 		;;
-	toast*)
-		kernel=toast
-		os=$(echo $basic_os | sed -e 's|toast|system|')
-		;;
 	*)
 		kernel=
 		os=$basic_os
@@ -1766,8 +1762,6 @@ case $kernel-$os in
 		;;
 	*-eabi* | *-gnueabi*)
 		;;
-	toast-system*)
-		;;
 	-*)
 		# Blank kernel with real OS is always fine.
 		;;
diff --git a/gcc/config.gcc b/gcc/config.gcc
index 7845297fdb2..d031417a21e 100644
--- a/gcc/config.gcc
+++ b/gcc/config.gcc
@@ -946,16 +946,8 @@ case ${target} in
   gnu_ld=yes
   default_use_cxa_atexit=yes
   use_gcc_stdint=wrap
-  
-  case ${target} in
-  *-toast-system*)
-	tmake_file="${tmake_file} t-slibgcc"
-	thread_file='posix'
-	;;
-	*)
-	echo "toast target '{target}' not supported."
-	exit 1
-  esac
+  tmake_file="${tmake_file} t-slibgcc"
+  thread_file='posix'
   ;;
 *-*-uclinux*)
   extra_options="$extra_options gnu-user.opt"
@@ -1942,16 +1934,6 @@ x86_64-*-freebsd*)
 	;;
 x86_64-*-toast*)
     tm_file="${tm_file} i386/unix.h i386/att.h dbxelf.h elfos.h gnu-user.h glibc-stdint.h i386/x86-64.h i386/gnu-user-common.h i386/gnu-user64.h toast.h i386/i386-toast.h"
-	
-	case ${target} in
-	*-toast-system*)
-		tm_file="${tm_file} toast-system.h"
-		;;
-	*)
-		echo "toast target '{target}' not supported."
-		exit 1
-	esac
-	
 	tmake_file="${tmake_file} i386/t-toast64"
     ;;
 i[34567]86-*-netbsdelf*)
diff --git a/gcc/config/toast-system.h b/gcc/config/toast-system.h
deleted file mode 100644
index 4019041bb7a..00000000000
--- a/gcc/config/toast-system.h
+++ /dev/null
@@ -1,2 +0,0 @@
-#undef LIB_SPEC
-#define LIB_SPEC "-lc"
\ No newline at end of file
diff --git a/gcc/config/toast.h b/gcc/config/toast.h
index 9fb5a177bf5..fa19b17a607 100644
--- a/gcc/config/toast.h
+++ b/gcc/config/toast.h
@@ -1,7 +1,7 @@
 /* Useful if you wish to make target-specific GCC changes. */
 #undef TARGET_TOAST
 #define TARGET_TOAST 1
- 
+
 #undef TARGET_OS_CPP_BUILTINS
 #define TARGET_OS_CPP_BUILTINS()      \
   do {                                \
@@ -11,6 +11,9 @@
     builtin_assert ("system=unix");   \
     builtin_assert ("system=posix");   \
   } while(0);
+
+#undef LIB_SPEC
+#define LIB_SPEC "-lc"
   
 #undef STARTFILE_SPEC
 #define STARTFILE_SPEC "crt0.o%s crti.o%s crtbegin.o%s"
-- 
2.30.2.windows.1

